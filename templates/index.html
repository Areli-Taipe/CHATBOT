<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
</head>
<style>
    body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: white;
}

header {
    padding: 20px;
    text-align: center;
    color: white;
    background-image: url(static/img/fondo1.webp);
    background-size: cover;
    background-position: center center;
    width: auto;
    height: 300px;
}
header img {
    width: 150px;
    height: 150px;
}
nav ul {
    list-style: none;
    padding: 0;
}

nav li {
    display: inline-block;
    margin: 0 10px;
    margin-top: 15px;
}

/* Agrega más estilos según tus necesidades */
nav li a{
    text-decoration: none;
    color: white;
    font-family: Verdana, Geneva, Tahoma, sans-serif;
    font-size: 15px;
    font-weight: bolder;
}
.main{
    display: flex;
    flex-wrap: wrap; /* Permite que los elementos se envuelvan en pantallas más pequeñas */
    justify-content: space-between; /* Distribuye el espacio entre elementos */
    gap: 20px; /* Espacio entre los elementos */
    padding: 20px; /* Espacio interior del contenedor principal */
}
main section{
    background: radial-gradient(circle at center, #cff169,#84f6fa);
    border-radius: 15px;
    flex: 1;
    min-width: 280px; /* Ajusta el ancho mínimo */
    max-width: 100%; /* Evita que el ancho sea mayor que el contenedor principal */
    box-sizing: border-box;
    padding: 20px;
    text-align: center;
}
.item {
    border-radius: 15px;
    padding: 10px;
    text-align: center;
    margin-bottom: 20px;
}
.item img {
    width: 100%; /* Hace que la imagen sea responsiva */
    max-width: 500px; /* Tamaño máximo para pantallas grandes */
    height: auto; /* Mantiene la proporción de la imagen */
    display: block; /* Evita el espacio extra debajo de la imagen */
    margin: 0 auto; /* Centra la imagen dentro del contenedor */
}
footer {
    background-color: rgb(2, 39, 143);
    color: white;
    margin: 0;
    padding: 0;
    padding: 20px;
    text-align: center;
}
/* Estilos del contenedor del chat */
#chat-container {
    width: 90%; /* Cambiado a porcentaje para que se ajuste mejor a diferentes tamaños de pantalla */
    max-width: 800px; /* Añadido un ancho máximo */
    height: auto; /* Ajustado a auto para mejor adaptabilidad */
    margin: 20px auto;
    border: 1px solid #a6dbee;
    background: radial-gradient(circle at center, #cff169,#5a7ee8);
    padding: 10px;
    border-radius: 25px;
}
/* Estilos del área de mensajes */
#chatMessages {
    height: 300px;
    overflow-y: auto; /* Cambiado a auto para evitar barras de desplazamiento innecesarias */
    border: 1px solid #778aa7;
    padding: 10px;
    margin-bottom: 10px;
}
/* Estilos del input de usuario */
#userInput {
    width: calc(100% - 120px); /* Ajustado para que se ajuste a diferentes tamaños de pantalla */
    padding: 5px;
    margin: 5px 10px 5px 0;
    box-sizing: border-box;
}
/* Estilos del botón */
button {
    padding: 5px 10px;
    background-color: rgb(43, 253, 1);
    border-radius: 5px;
    font-weight: bold;
    margin-top: 5px; /* Ajustado el margen superior */
    width: 100%; /* Cambiado para que ocupe el ancho completo en pantallas pequeñas */
    max-width: 120px; /* Añadido un ancho máximo */
    height: 40px;
}
/* Cambios en el hover del botón */
button:hover {
    background-color: yellow;
    transform: scale(1.1); /* Ajustado el efecto de escala */
    box-shadow: 0 0 10px #f0a40b;
    transition: transform 0.3s; /* Ajustado la transición */
}
#loading {
    text-align: center;
    margin-top: 15px;
    color: red;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: bold;
}
.user-message {
    text-align: right;
    color: black;
    margin-bottom: 15px;
}/* Estilos de los mensajes del usuario y del bot */
.message {
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 10px; /* Ajustado el margen inferior */
}

.bot-message {
    color: #001451;
}

.bot-message {
    background-color: #cadfed;
    margin-bottom: 15px;
}

.user-message {
    background-color: #e2e5d2;
    text-align: right;
    margin-bottom: 15px;
}
/* Ajustes para pantallas pequeñas */
@media (max-width: 768px) {
    main section.item {
        width: calc(100% - 20px); /* Reduce el ancho en pantallas más pequeñas */
        max-width: none; /* Elimina el ancho máximo para adaptarse mejor */
        margin: 10px; /* Ajusta el margen en pantallas más pequeñas */
    }

    /* Ajustar el tamaño de la imagen dentro de la sección */
    main section.item img {
        width: 100%; /* Hace que la imagen ocupe todo el ancho disponible */
        height: auto; /* Mantiene la relación de aspecto */
    }
}

@media (max-width: 480px) {
    main section.item {
        width: calc(100% - 10px); /* Ajusta aún más el ancho en pantallas muy pequeñas */
        margin: 5px; /* Reduce el margen en pantallas muy pequeñas */
    }

    /* Ajustar aún más el tamaño de la imagen dentro de la sección */
    main section.item img {
        width: 100%;
        height: auto;
    }
}
/* Consulta de medios para pantallas pequeñas */
@media (max-width: 600px) {
    #chat-container {
        width: 95%; /* Ajustado el ancho para pantallas pequeñas */
    }

    #userInput {
        width: calc(100% - 120px); /* Ajuste del ancho para pantallas más pequeñas */
    }

    button {
        width: 100%; /* Botón ocupa el ancho completo */
    }
}
</style>
<body>
    <header>
        <h1>Colegio José Gálvez</h1>
        <img src="static/img/insignia.jpg" alt="">
        <nav>
            <ul>
                <li><a href="#">Inicio</a></li>
                <li><a href="#">Acerca de</a></li>
                <li><a href="#">Admisiones</a></li>
                <li><a href="#">Contacto</a></li>
            </ul>
        </nav>
    </header>
    <div class="main">
        <main>
            <section class="item">
                <h2>Bienvenidos</h2>
                <p>Le damos la bienvenida a la pagina web de la Institucion Educativa Jose Galvez.</p>
            </section>
            <section class="item">
                <h2>Nuestro Colegio</h2>
                <p>La Institución Educativa José Gálvez, fue creada con la Resolución Directoral-005-82-La Merced, jurisdicción de la tercera Región de Educación de Junín, el 02 de mayo de 1982, en tanto la Escuela Rural PRE vocacional N°5204 del anexo de Rio Negro, Distrito de Satipo, fue creado mediante una R.D.N° 97458 del 09 de junio de 1942. La iniciativa de la integración por parte del presidente de APAFA del nivel primaria señor Victor Astoray Castillo, en coordinación con la Dirección del nivel primaria y el nivel secundaria el presidente de APAFA el señor Hernan Garcia, siendo el director el profesor Gilberto Bendezú Montero, en una reunión de docentes y directivos se logra la aceptación por parte de su mayoría. Obteniéndose una primera R.D. en el mes de febrero de 1994, comenzando la unificación como Centro Educativo Integrado de los niveles de primaria y secundaria. Desde entonces somos una Institución Educativa Integrado, con las especialidades de Industrias Alimentarias y Computación.</p>
            </section>
        </main>
    </div>

    <div id="chat-container">
        <div id="chatMessages"></div>
        <input type="text" id="userInput" placeholder="Escribe tu mensaje...">
        <button id="myButton">Enviar</button>
        <div id="loading" style="display: none;">Cargando...</div>
    </div>

    <footer>
        <p>&copy; Areli Taipe & Harby Santos</p>
    </footer>

    <script>
        //Obtener el botón y el elemento de carga.
        const button = document.getElementById('myButton');
        const loadingDelay = 800; 
        //Agregue un detector de eventos de clic al botón
        button.addEventListener('click', sendMessage);

        //Función para manejar el proceso de envío de mensajes.
        function sendMessage() {
            //Obtener el elemento de entrada del usuario y su valor.
            const userInputElement = document.getElementById('userInput');
            // Convertir a minúsculas 
            let userInput = userInputElement.value.trim().toLowerCase(); 
            // Elimina cualquier espacio inicial o final mediante trim().
            // Mostrar el mensaje del usuario (antes de limpiar)
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML += `<div class="message user-message"><strong>Tú:</strong> ${userInput}</div>`;

            document.getElementById('loading').style.display = 'block'; // Mostrar el spinner
            
            // Enviar el mensaje al servidor
            fetch('/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({message: userInput}),
            })
            .then(response => {
                // Comprueba si la respuesta es exitosa.
                if (!response.ok) {
                    throw new Error('Error en la respuesta del servidor: ' + response.status);
                }
                return response.json();
            })
            .then(data => {
                // Retrasa la respuesta
                setTimeout(() => {
                    // Mostrar la respuesta del chatbot
                    chatMessages.innerHTML += `<div class="message bot-message"><strong>Chatbot:</strong> ${data.response}</div>`;
                    chatMessages.scrollTop = chatMessages.scrollHeight; // Desplazar hacia abajo
                    document.getElementById('loading').style.display = 'none'; // Ocultar el spinner
                }, loadingDelay);
            })
            .catch(error => {
                console.error('Error:', error);
            });

            // Limpiar el campo de entrada
            userInputElement.value = '';
        }
    </script>
</body>
</html>
